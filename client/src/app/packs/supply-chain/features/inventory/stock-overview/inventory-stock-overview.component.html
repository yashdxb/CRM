<div class="page-background">
  <div class="animated-orb orb-1"></div>
  <div class="animated-orb orb-2"></div>
  <div class="animated-orb orb-3"></div>
  <div class="animated-orb orb-4"></div>
</div>

<div class="page-container">
  <div class="page-content inventory-overview">
    <app-breadcrumbs></app-breadcrumbs>

    <section class="hero-section">
      <div class="hero-content">
        <div class="hero-text">
          <h1 class="page-title gradient-cyan">Inventory Stock Overview</h1>
          <p class="page-subtitle">
            Monitor stock coverage, value exposure, and replenishment priorities across the network.
          </p>
        </div>
        <div class="hero-actions">
          <p-select
            [options]="regions"
            [(ngModel)]="selectedRegionValue"
            optionLabel="label"
            optionValue="value"
            placeholder="Filter by region"
          ></p-select>
          <p-button label="Download snapshot" icon="pi pi-download" styleClass="btn-glass"></p-button>
        </div>
      </div>
    </section>

    <section class="glass-card summary-card">
      <div class="metric-strip">
        <div class="metric-card" *ngFor="let metric of metrics()" [ngClass]="metric.trend">
          <span class="metric-label">{{ metric.label }}</span>
          <div class="metric-value">{{ metric.value }}</div>
          <span class="metric-delta">
            <i
              class="pi"
              [ngClass]="{
                'pi-arrow-up-right': metric.trend === 'up',
                'pi-arrow-down-right': metric.trend === 'down',
                'pi-minus': metric.trend === 'flat'
              }"
            ></i>
            {{ metric.delta }}
          </span>
        </div>
      </div>
    </section>

    <div class="content-grid">
      <section class="glass-card warehouse-card">
        <div class="card-header">
          <div>
            <h2 class="card-title">Warehouse health</h2>
            <p class="card-subtitle">{{ filteredWarehouses().length }} sites · {{ totalInventoryValue() }}M USD on hand</p>
          </div>
          <div class="header-actions">
            <p-button label="Rebalance" icon="pi pi-sync" styleClass="btn-glass" size="small"></p-button>
            <p-button label="Create transfer" icon="pi pi-send" styleClass="btn-gradient" size="small"></p-button>
          </div>
        </div>
        <div class="card-body">
          <p-table [value]="filteredWarehouses()" dataKey="name" responsiveLayout="scroll">
            <ng-template pTemplate="header">
              <tr>
                <th>Warehouse</th>
                <th>Region</th>
                <th>Days of cover</th>
                <th>Inventory value</th>
                <th>Fill rate</th>
                <th>Health</th>
                <th></th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-site>
              <tr>
                <td>
                  <div class="warehouse-cell">
                    <span class="name">{{ site.name }}</span>
                    <small>{{ site.skuCount | number }} SKUs</small>
                  </div>
                </td>
                <td>{{ site.region }}</td>
                <td>
                  <div class="coverage">
                    <span>{{ site.coverageDays }} days</span>
                    <span class="coverage-trend" [ngClass]="site.trend">
                      <i
                        class="pi"
                        [ngClass]="{
                          'pi-arrow-up': site.trend === 'up',
                          'pi-arrow-down': site.trend === 'down',
                          'pi-minus': site.trend === 'flat'
                        }"
                      ></i>
                    </span>
                  </div>
                </td>
                <td>${{ site.inventoryValue | number: '1.1-1' }}M</td>
                <td>
                  <div class="fill-rate">
                    <p-progressBar [value]="site.fillRate"></p-progressBar>
                    <small>{{ site.fillRate }}%</small>
                  </div>
                </td>
                <td>
                  <p-tag [value]="site.health" [severity]="severity(site.health)"></p-tag>
                </td>
                <td class="row-actions">
                  <p-button icon="pi pi-ellipsis-v" [text]="true"></p-button>
                </td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </section>

      <aside class="right-column">
        <section class="glass-card risk-card">
          <div class="card-header">
            <h2 class="card-title">Inventory watchlist</h2>
            <p-button label="View dashboard" [text]="true" size="small"></p-button>
          </div>
          <div class="card-body">
            <div class="risk-item" *ngFor="let risk of risks()">
              <div>
                <span class="sku">{{ risk.sku }}</span>
                <p class="product">{{ risk.product }}</p>
                <small>{{ risk.supplier }}</small>
              </div>
              <div class="risk-meta">
                <p-tag [value]="risk.risk" severity="danger"></p-tag>
                <span class="risk-action">{{ risk.action }}</span>
                <small class="eta">ETA {{ risk.eta }}</small>
              </div>
            </div>
          </div>
        </section>

        <section class="glass-card replenishment-card">
          <div class="card-header">
            <h2 class="card-title">Replenishment queue</h2>
            <p-button label="Create plan" icon="pi pi-plus" styleClass="btn-glass" size="small"></p-button>
          </div>
          <div class="card-body">
            <div class="replenishment-item" *ngFor="let order of replenishments()">
              <div class="order-head">
                <span class="reference">{{ order.reference }}</span>
                <p-tag [value]="order.status"></p-tag>
              </div>
              <div class="order-body">
                <span>{{ order.warehouse }}</span>
                <small>{{ order.lines }} lines · {{ order.supplier }}</small>
              </div>
              <div class="order-footer">
                <span>{{ order.arrival }}</span>
                <p-button label="Details" size="small" [text]="true"></p-button>
              </div>
            </div>
          </div>
        </section>
      </aside>
    </div>
  </div>
</div>
