<div class="page-background">
  <div class="animated-orb orb-1"></div>
  <div class="animated-orb orb-2"></div>
  <div class="animated-orb orb-3"></div>
  <div class="animated-orb orb-4"></div>
</div>

<div class="page-container">
  <div class="page-content quality-inspection">
    <app-breadcrumbs></app-breadcrumbs>

    <section class="hero-section">
      <div class="hero-content">
        <div class="hero-text">
          <h1 class="page-title gradient-violet">Quality Inspection</h1>
          <p class="page-subtitle">Coordinate inspection workload, resolve hold lots, and keep production supplied with certified materials.</p>
        </div>
        <div class="hero-actions">
          <p-button label="Assign inspector" icon="pi pi-user-plus" styleClass="btn-glass"></p-button>
          <p-button label="Create inspection lot" icon="pi pi-plus-circle" styleClass="btn-gradient"></p-button>
        </div>
      </div>
    </section>

    <section class="glass-card hero-metrics">
      <div class="metric-card">
        <span class="metric-label">Completion rate</span>
        <div class="metric-value">{{ completionRate() }}%</div>
        <small>{{ lots().length }} lots in the queue</small>
      </div>
      <div class="metric-card backlog">
        <span class="metric-label">Awaiting inspection</span>
        <div class="metric-value">{{ backlogCount() }}</div>
        <small>Assign resources to keep docks flowing</small>
      </div>
      <div class="metric-card holds">
        <span class="metric-label">Lots on hold</span>
        <div class="metric-value">{{ holdCount() }}</div>
        <small>Escalate to supplier quality</small>
      </div>
    </section>

    <section class="glass-card summary-strip">
      <div class="card-header">
        <h2 class="card-title">Shift summary</h2>
      </div>
      <div class="card-body">
        <div class="summary-grid">
          <div class="summary-tile" *ngFor="let item of summary()">
            <span class="window">{{ item.window }}</span>
            <div class="counts">
              <span class="count">{{ item.completed }}/{{ item.lots }} done</span>
              <span class="issues">{{ item.defects }} defects flagged</span>
            </div>
            <p-progressBar [value]="percentage(item.completed, item.lots)"></p-progressBar>
          </div>
        </div>
      </div>
    </section>

    <section class="glass-card lots-table">
      <div class="card-header">
        <h2 class="card-title">Inspection lots</h2>
        <p-button label="Filter" icon="pi pi-sliders-h" [text]="true"></p-button>
      </div>
      <div class="card-body">
        <p-table [value]="lots()" responsiveLayout="scroll" dataKey="lotId">
          <ng-template pTemplate="header">
            <tr>
              <th>Lot ID</th>
              <th>Supplier</th>
              <th>PO / SKU</th>
              <th>Received vs inspected</th>
              <th>Status</th>
              <th>Defects</th>
              <th>Owner</th>
              <th></th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-lot>
            <tr>
              <td>{{ lot.lotId }}</td>
              <td>{{ lot.supplier }}</td>
              <td>
                <div class="po-cell">
                  <span>{{ lot.po }}</span>
                  <small>{{ lot.sku }}</small>
                </div>
              </td>
              <td>
                <div class="progress-wrap">
                  <p-progressBar [value]="percentage(lot.inspectedQty, lot.receivedQty)"></p-progressBar>
                  <small>{{ lot.inspectedQty | number }} / {{ lot.receivedQty | number }}</small>
                </div>
              </td>
              <td><p-tag [value]="lot.status" [severity]="statusSeverity(lot.status)"></p-tag></td>
              <td>{{ lot.defects }}</td>
              <td>
                <div class="owner-cell">
                  <span>{{ lot.owner }}</span>
                  <div class="tag-strip">
                    <p-chip *ngFor="let tag of lot.tags" [label]="tag"></p-chip>
                  </div>
                </div>
              </td>
              <td class="row-actions">
                <p-button icon="pi pi-pencil" [text]="true" label="Update"></p-button>
                <p-button icon="pi pi-times-circle" [text]="true" label="Place on hold"></p-button>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </section>
  </div>
</div>
